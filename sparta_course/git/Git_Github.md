# Git & Github

<br>

- gitを使うメリット 
 - スピーディー
 - シンプルな設計
 - ブランチが並列で開発可能
 - 大規模プロジェクトを効率的に取り扱える

- githubとは
 - プルリクエストで複数人での開発が可能
 - 世界中のチームがGithub上で開発可能

- gitは、データをスナップショットを記録する
 - 変更があったファイルをスナップショットとして記録
 - 変更がなかったファイルは前回分を使用する

- なぜ、スナップショットで記録するのか？
 - 複数人で開発する際のスピードを上げることが出来る
   - ブランチを切れるから
 - 差分で記録していると
   - マージする際に逐一差分を計算しないといけなくなる

- gitは、前のバージョンに戻すことが出来る
 - バージョンを記録しているから
 - 最新のコミットする際に直前のコミットも記録する

- リポジトリとは、履歴データの置き場、履歴データのデータベース
- コミットとは、スナップショットを記録すること
- ローカルリポジトリとは、自分のパソコン上の履歴データの保管場所
- ワークツリーとは、自分のパソコン上の作業場
- Githubとは、ネットワーク上のコード置き場

<br>

ローカルでスナップショットを記録→Githuへアップするまでの流れ
1. ワークツリーでファイルを変更
2. ローカルリポジトリにスナップショットを保存
3. ローカルリポジトリからGithubへアップ

<br>

他人のリポジトリを変更するまでの流れ
1. Githubの記録をローカルリポジトリへ
2. ワークツリーにローカルリポジトリからGithubの記録を反映

<br>

- ローカルは３つのエリアに分かれている
 - ワークツリー
 - ステージ
 - リポジトリ

<br>

1. ワークツリーでファイルを変更
2. git add にて、ステージでコミットする変更を準備する
3. git commit にてローカルリポジトリにスナップショットを記録する

- なぜいったんステージに上げるのか
 - 沢山のファイルを変更している際に、変更が完了したファイルだけのスナップショットを記録したいから

<br>

- git add にて起こること
 - ワークツリーで作業したファイルの圧縮ファイルをリポジトリに作成
   - 圧縮ファイルになるのは、変更されたファイルのみ
 - ステージにインデックスとして、作業したファイルと圧縮ファイルを保管する

- git commit にてツリーとコミットが作成される
 - ツリーとは、インデックスの中身まるっとそのまま
 - コミットに含まれる情報
   - ツリー情報
     - コミットした際のスナップショット(ファイル構成(ファイル名+ファイル内容))がわかる
   - 親コミット
     - 直前のコミット情報（スナップショット）
   - 作成者
   - 日付
   - コミットメッセージ

<br>

ファイル変更からgit commitまででそれぞれのエリアに含まれるもの
- ワークツリーには、変更したファイル
- ステージには、インデックス
- リポジトリには、圧縮ファイルとツリーとコミット

<br>

- Gitのデータ構造のまとめ
 - リポジトリに「圧縮ファイル」「ツリー」「コミット」ファイルを作成することでデータを保存している
 - コミットが親コミットを持つことで変更履歴を辿ることが出来る
 - Gitの本質はデータを圧縮して、スナップショットで保存していること
 - gitコマンドは、そのデータに対していろいろな操作をしている

<br>

- `Gitオブジェクト`とは、`git add`や`git commit`した時に作成される`圧縮ファイル`、`ツリーファイル`、`コミットファイル`のこと。Gitオブジェクトは、`.git/objects`ディレクトリの下に保存される

<br>

- `圧縮ファイル`とは、ファイルの中身そのものを圧縮したもの。正確には`blobオブジェクト`という。圧縮ファイルには、元のファイル名の情報は記録されない。ファイル名は`ハッシュID`になるから。
 - blobとは、カタマリという意味
 - ハッシュIDは、40文字の英数字
 - ハッシュIDは、ファイルの中身に対して一意になる

<br>

- `ツリーファイル`とは、１つのファイルに１つの圧縮ファイルが対応していて、１つのディレクトリに１つのツリーファイルが対応している。ツリーファイルは、構造や名前を持たない圧縮ファイルに構造を与えるもので、圧縮ファイルやツリーファイルを保存している
 - ディレクトリの１つの階層ごとに１つのツリーファイルになっている
 - ツリーファイルには、圧縮ファイルだけでなく、ツリーファイルも保存されている

<br>

- `コミットファイル`とは、いつ・誰が・何を・何のためにhンこうしたのかなどの情報を保存するもの。正確には、`commitオブジェクト`という

<br>

※treeコマンドのインストール方法(homebrewインストール済み)
`$ brew install tree`

<br>

- ローカルリポジトリの作成
 - `$ git init`
   - `.git/`ディレクトリが作成される
     - `.git/objects` (リポジトリ) 
       - 圧縮ファイル
       - ツリーファイル
       - コミットファイル
     - インデックスファイル
     - 設定ファイル

メモ）git add をすることで、.git/indexディレクトリが作成される

<br>

- ステージへの追加
 - git add <ファイル名>
 - git add <ディレクトリ名>
 - git add . 

<br>

- `$ git commit -v`
  - 変更内容を確認したい時

<br>

- `$ git status`
  - ワークツリーとステージ間で変更されたファイル情報
    - インデックスが保持していないファイルが表示される
    - `change not staged for commit:`
  - ステージとリポジトリ間で変更されたファイル情報
    - 前回コミットしてからステージに追加されたファイルが表示される
    - `change to be committed`

<br>

- git addする前の変更分を確認
  - `$ git diff`
  - `$ git diff <ファイル名>`

- git addした後の変更分を確認
  - `$ git diff --staged`

<br>

- 変更履歴の確認
-  `$ git log`
- `$ git log --oneline`
  - 一行で表示させる
- `$ git log -p <ファイル名> `
  - ファイル名の変更差分を表示
- `$ git log -n <コミット数>`
  - 表示するコミット数を制限
